<!DOCTYPE html>
<html>
	<head>
		
			<title>Getting Started</title>
		
		<meta charset="UTF-8"/>
		<meta name="viewport" content="width=device-width, initial-scale=1"/>
		
		<link rel="icon" type="image/png" href="../../_static/icon.png"/>
		<link rel="stylesheet" href="../../_static/site.css" type="text/css" media="screen"/>
		
		<script src="../../_components/jquery/jquery.min.js"></script>
		<script src="../../_components/jquery-syntax/jquery.syntax.min.js"></script>
		
		<script src="../../_static/links.js"></script>
		
		<script type="text/javascript">
		//<![CDATA[
			jQuery(function($) {
				$.syntax();
			});
		//]]>
		</script>
	</head>

	<body>
		<header> › <a class="link" href="../../index.html">Project</a> › <a class="link" href="../index.html">Guides</a></header>
		
		<main>
			
	<h1>Getting Started</h1>
	
	<p>This guide explains how to use <code>live</code> to render dynamic content in real-time.</p>
<section id="installation"><h2>Installation</h2>
<p>Add the gem to your project:</p>
<pre><code class="language-bash">$ bundle add live
</code></pre>
<p>Install the JavaScript client:</p>
<pre><code class="language-bash">$ npm add @socketry/live
</code></pre>
</section><section id="core-concepts"><h2>Core Concepts</h2>
<p><code>live</code> has several core concepts:</p>
<ul>
<li>A <a href="../../source/Live/View/index.html" title="Live::View"><code class="language-ruby">class Live::View</code></a> which represents a single content area on a web page.</li>
<li>A <a href="../../source/Live/Page/index.html" title="Live::Page"><code class="language-ruby">class Live::Page</code></a> which represents a single page on the client side with zero or more bound views which can be dynamically updated.</li>
</ul>
</section><section id="implementing-a-view"><h2>Implementing a View</h2>
<p>This view tracks how many times it's been clicked.</p>
<pre><code class="language-ruby">require 'live/view'

class ClickCounter &lt; Live::View
	def initialize(id, **data)
		super
		
		# Setup the initial state:
		@data[:count] ||= 0
	end
	
	# Handle a client event which was forwarded to the server:
	def handle(event, details)
		@data[:count] = Integer(@data[:count]) + 1
		
		replace!
	end
	
	def render(builder)
		# Forward the `onclick` event to the server:
		builder.tag :button, onclick: forward do
			builder.text(&quot;I've been clicked #{@data[:count]} times!&quot;)
		end
	end
end

</code></pre>
<p>Render the tag in your view layer:</p>
<pre><code class="language-ruby">#{ClickCounter.new('click-counter').to_html}
</code></pre>
</section><section id="implementing-the-server"><h2>Implementing the Server</h2>
<p>On the server side, in the controller layer, we need to handle the incoming WebSocket request:</p>
<pre><code class="language-ruby"># This controls which classes can be created by the client tags:
RESOLVER = Live::Resolver.allow(ClickCounter)

# At the same path as the request:
on 'live' do |request|
	Async::WebSocket::Adapters::Rack.open(request.env) do |connection|
		Live::Page.new(RESOLVER).run(connection)
	end
end
</code></pre>
<p>You will need to host this using an <code>async</code>-aware server, like (Falcon)[https://github.com/socketry/falcon].</p>
</section><section id="example-server"><h2>Example Server</h2>
<p>You can try the included example in <code>example/basic</code>.</p>
</section><section id="start-the-server"><h3>Start the Server</h3>
<pre><code class="language-bash">$ cd example/basic
$ falcon serve
</code></pre>
</section><section id="connect-the-browser"><h3>Connect the Browser</h3>
<p>Open <code>https://localhost:9292</code> and enjoy the example. You may like to use the inspector to see the messages going across the WebSocket connection.</p>
</section>
				
			<footer>Documentation generated by <a href="https://github.com/socketry/utopia-project">Utopia::Project</a>.</footer>
		</main>
	</body>
</html>